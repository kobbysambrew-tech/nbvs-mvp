<!DOCTYPE html>
<html>
<head>
  <title>NBVS Analytics</title>
  <style>
    body { font-family: Arial; padding: 20px; background:#f8f9fa; }
    h1 { color:#006b3f; }
    table { width:100%; border-collapse: collapse; margin-top:20px; }
    th, td { border:1px solid #ccc; padding:8px; }
    th { background:#006b3f; color:white; }
  </style>
</head>
<body>
  <h1>NBVS Analytics Dashboard</h1>
  <p><b>Total Searches:</b> <span id="total"></span></p>

  <table>
    <thead>
      <tr>
        <th>Search Term</th>
        <th>Timestamp</th>
        <th>Platform</th>
      </tr>
    </thead>
    <tbody id="logs"></tbody>
  </table>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js";
    import { getFirestore, collection, getDocs } 
      from "https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCDh_qL3jiCMHROK0_Soul2Wsv3t3y4wv0",
      authDomain: "nbvs-ghana.firebaseapp.com",
      projectId: "nbvs-ghana",
      storageBucket: "nbvs-ghana.firebasestorage.app",
      messagingSenderId: "702636577113",
      appId: "1:702636577113:web:8369b43a2aa43aeb95fc48",
      measurementId: "G-2FHFSQRMZX"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function loadLogs() {
      const snap = await getDocs(collection(db, "search_logs"));
      document.getElementById("total").textContent = snap.size;

      const logsDiv = document.getElementById("logs");
      snap.forEach(doc => {
        const r = doc.data();
        const row = `
          <tr>
            <td>${r.searchTerm}</td>
            <td>${r.timestamp?.toDate()}</td>
            <td>${r.platform}</td>
          </tr>
        `;
        logsDiv.innerHTML += row;
      });
    }

    loadLogs();
  </script>
</body>
</html>
