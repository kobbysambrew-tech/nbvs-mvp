<!DOCTYPE html>
<html>
<head>
  <title>NBVS Analytics Dashboard</title>
  <style>
    body{font-family:Arial;background:#f8f9fa;padding:20px}
    h1{color:#006b3f}
    table{width:100%;border-collapse:collapse;margin-top:20px}
    th,td{border:1px solid #ccc;padding:10px}
    th{background:#006b3f;color:#fff}
  </style>
</head>

<body>
<h1>NBVS Analytics Dashboard</h1>
<p><b>Total Searches:</b> <span id="total">0</span></p>

<table>
<thead>
  <tr>
    <th>Search Term</th>
    <th>Timestamp</th>
    <th>Platform</th>
  </tr>
</thead>
<tbody id="logs"></tbody>
</table>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCDh_qL3jiCMHROK0_Soul2Wsv3t3y4wv0",
  authDomain: "nbvs-ghana.firebaseapp.com",
  projectId: "nbvs-ghana",
  storageBucket: "nbvs-ghana.firebasestorage.app",
  messagingSenderId: "702636577113",
  appId: "1:702636577113:web:8369b43a2aa43aeb95fc48",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const totalEl = document.getElementById("total");
const logsEl = document.getElementById("logs");

async function loadLogs(){
  const data = await getDocs(collection(db,"search_logs"));

  logsEl.innerHTML = "";
  let count = 0;

  data.forEach(docSnap=>{
    const d = docSnap.data();
    count++;

    logsEl.innerHTML += `
      <tr>
        <td>${d.term}</td>
        <td>${new Date(d.timestamp.toMillis()).toLocaleString()}</td>
        <td>${d.platform}</td>
      </tr>
    `;
  });

  totalEl.textContent = count;
}

loadLogs();
</script>

</body>
</html>
